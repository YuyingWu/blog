

<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="renderer" content="webkit">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="description" content="">

	
<link rel="stylesheet" href="/blog//css/post.css">


	<title>悄悄发布一个hexo的npm模块 - 伍酱</title>

	<!--[if lte IE 8]>
        <script>
            (function(){
                var e="abbr,article,aside,audio,canvas,datalist,details,dialog,eventsource,figure,footer,header,hgroup,mark,menu,meter,nav,output,progress,section,time,video".split(","),
                i=e.length;
                while(i--){document.createElement(e[i])}
             })();
        </script>
    <![endif]-->
</head>
<body class="page-post">

<script async>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-74424222-1', 'auto');
	ga('send', 'pageview');
</script>


<!--[if lte IE 8]>
    <p class="browserupgrade">貌似你还在用<strong>低版本IE</strong>浏览器喔~ 为了更好的体验，去下载一个<a href="https://www.baidu.com/s?ie=utf-8&f=8&rsv_bp=0&rsv_idx=1&tn=baidu&wd=chrome&rsv_pq=c275ed8c0000204b&rsv_t=b404%2BiFxvZfvn%2FqqBMyJKwHyShj%2FipQgL7TfJsGKrHxZhoWCUisbVukJsNw&rqlang=cn&rsv_enter=1&rsv_sug3=6&rsv_sug1=5&rsv_sug7=100&rsv_sug2=0&inputT=891&rsv_sug4=891" target="_blank">最新版Chrome</a>吧 ：）</p>
<![endif]-->


	<header>
	<section class="u-clearfix header__container">
		<nav class="grid-r header__nav--list">
			
				<a href="/blog/">Blog</a>
			
				<a href="/blog/archives/">Archive</a>
			
				<a href="/blog/about.html">About</a>
			
		</nav>

		<h1 class="grid">
			<a href="/">伍酱</a>
		</h1>
	</section>
</header><!-- /header -->


<div id="content">
	<div class="center">
		<div class="main-col">
			
	
	<article class="article article-detail post article-post">
	<div class="post-content">
		<header>
			
	
		
			<h1 class="title" data-role="articleTitle">悄悄发布一个hexo的npm模块</h1>
		
	

			<div class="post__meta">
	<time datetime="2017-04-03T03:52:02.000Z">2017-04-03</time>

	
</div>
			
		</header>

		<div class="entry">
			<aside class="wgt-toc">
				<header>
					<p><i class="iconfont icon-folder"></i>&nbsp;文章大纲</p>
				</header>
				<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#怎么实现？"><span class="toc-number">1.</span> <span class="toc-text">怎么实现？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#top【No-1-Priority】"><span class="toc-number">1.1.</span> <span class="toc-text">top【No.1 Priority】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#updateDate【No-2-Priority】"><span class="toc-number">1.2.</span> <span class="toc-text">updateDate【No.2 Priority】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#date【Default】"><span class="toc-number">1.3.</span> <span class="toc-text">date【Default】</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#more-to-do"><span class="toc-number">1.4.</span> <span class="toc-text">more to do</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#发布npm模块"><span class="toc-number">2.</span> <span class="toc-text">发布npm模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#事前准备"><span class="toc-number">2.1.</span> <span class="toc-text">事前准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#发布"><span class="toc-number">2.2.</span> <span class="toc-text">发布</span></a></li></ol></li></ol>
			</aside>
			<p><strong>hexo-generator-index-plus</strong>，这是什么东东？其实就是hexo博客生成器的一个文章排序插件，基于默认插件fork的，添加按文章<strong>置顶</strong>和<strong>二次编辑的更新时间</strong>排序的功能。</p>
<p>沙发留给github和npmjs~</p>
<p>Github: <a href="https://github.com/YuyingWu/hexo-generator-index-plus" target="_blank" rel="noopener">YuyingWu/hexo-generator-index-plus</a><br>npm: <a href="https://www.npmjs.com/package/hexo-generator-index-plus" target="_blank" rel="noopener">hexo-generator-index-plus</a></p>
<p>最简单粗暴的Installation：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm <span class="keyword">install</span> hexo-generator-<span class="keyword">index</span>-plus <span class="comment">--save</span></span><br></pre></td></tr></table></figure></p>
<a id="more"></a>
<p>当然要完全替换掉默认的index生成器还不止这一步啦，还要干掉默认的npm模块和更新hexo-cli里面assets的引用~具体还是看看<a href="https://www.npmjs.com/package/hexo-generator-index-plus#installation" target="_blank" rel="noopener">readMe</a>啰。</p>
<h2 id="怎么实现？"><a href="#怎么实现？" class="headerlink" title="怎么实现？"></a>怎么实现？</h2><p>基于默认的hexo-generator-index的fork~所以大致跟原生的一致，config不一样，内部实现不一样。</p>
<p>实现代码还是不聊了，原理是利用数组处理的sort函数来做升降序排列而已啦，献丑献丑。</p>
<p>而关键字的优先级是这么排的，让文章按照<code>top</code>（置顶） -&gt; <code>updateDate</code>（二次更新时间） -&gt; <code>date</code>的降序排列~ 为什么我们需要<code>top</code>或者<code>updateDate</code>呢？</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">title:</span> Blog Log</span><br><span class="line"><span class="symbol">date:</span> <span class="number">2015</span><span class="number">-04</span><span class="number">-23</span> <span class="number">00</span>:<span class="number">35</span>:<span class="number">45</span></span><br><span class="line"><span class="symbol">updateDate:</span> <span class="number">2017</span><span class="number">-04</span><span class="number">-02</span> <span class="number">15</span>:<span class="number">13</span>:<span class="number">00</span></span><br><span class="line"><span class="symbol">top:</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h3 id="top【No-1-Priority】"><a href="#top【No-1-Priority】" class="headerlink" title="top【No.1 Priority】"></a>top【No.1 Priority】</h3><p>所谓的“置顶”，越大的数值排得越前，写了一篇棒棒的文章当然想让它永远在前排 ^0^</p>
<h3 id="updateDate【No-2-Priority】"><a href="#updateDate【No-2-Priority】" class="headerlink" title="updateDate【No.2 Priority】"></a>updateDate【No.2 Priority】</h3><p>默认按创建时间<code>date</code>排序，但达不到针对偶尔编辑的某篇文章，希望把它顶上来的需求（但不是置顶，还是按修改时间排序就好了）。</p>
<p>所以我添加了针对<strong>二次编辑更新时间</strong>的排序，添加了一个<code>updateDate</code>，跟原生的<code>updated</code>区分开。我看默认有个<code>updated</code>属性，但是貌似是系统记录文章编辑保存的时间，人肉编辑也没有效，所以还是自己加一个吧。</p>
<h3 id="date【Default】"><a href="#date【Default】" class="headerlink" title="date【Default】"></a>date【Default】</h3><p>原生generator支持的创建日期排序。</p>
<h3 id="more-to-do"><a href="#more-to-do" class="headerlink" title="more to do"></a>more to do</h3><ul>
<li>目前只按照各个关键属性的默认降序，后续会加一个order_by支持自定义升降序的配置。</li>
<li>完成代码测试</li>
</ul>
<h2 id="发布npm模块"><a href="#发布npm模块" class="headerlink" title="发布npm模块"></a>发布npm模块</h2><p>好惭愧，第一次在社区发布module，把这些步骤记录下来，方便以后给自己备忘，嘻嘻。</p>
<h3 id="事前准备"><a href="#事前准备" class="headerlink" title="事前准备"></a>事前准备</h3><ol>
<li>去<a href="https://www.npmjs.com" target="_blank" rel="noopener">npm社区</a>注册一个账号</li>
<li>github创建repository</li>
<li>初始化模块，执行<code>npm init</code>，系统会有很多提示的，不想输入一直按回车就可以，初始化成功后，会生成<code>package.json</code></li>
</ol>
<h3 id="发布"><a href="#发布" class="headerlink" title="发布"></a>发布</h3><p>i. 设置npm用户</p>
<p>这个账号会被添加到npm本地的配置中，用来发布module用，成功后用户信息会被存到<code>~/.npmrc</code>。</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ npm adduser</span><br><span class="line"></span><br><span class="line"><span class="symbol">Username:</span> your name</span><br><span class="line"><span class="symbol">Password:</span> your password</span><br><span class="line"><span class="symbol">Email:</span> your email address</span><br><span class="line"></span><br><span class="line"><span class="comment">// 执行下面命令可以查看当前用户</span></span><br><span class="line">$ npm whoami</span><br></pre></td></tr></table></figure>
<p>ii. 设定版本号</p>
<p><code>package.json</code>里有个字段<code>version</code>，设定模块版本号</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm publish</span></span><br></pre></td></tr></table></figure>
<p>那么版本号规则一般是怎样的呢？npm社区有语义化版本的规则的~</p>
<p>版本格式：<strong>主版号.次版号.修订号</strong>，递增规则如下：</p>
<blockquote>
<p>主版号：当你做了不相容的 API 修改，<br>次版号：当你做了向下相容的功能性新增，<br>修订号：当你做了向下相容的问题修正。</p>
</blockquote>
<p>由于时间关系，在<code>npm publish</code>后，我们的模块就发布成功了，快到没朋友，到<a href="https://www.npmjs.com" target="_blank" rel="noopener">npm社区</a>自己的主页上就能看到啦~ </p>
<p>还蛮好玩的有木有，大家积极分享自己的模块吧 ：）</p>

		</div>

		<footer>
			
	<section class="post__meta post__tag">
		
			<a href="/blog/tags/blog/">blog</a>
		
			<a href="/blog/tags/hexo-generator-index-plus/">hexo-generator-index-plus</a>
		
			<a href="/blog/tags/hexo-plugin/">hexo-plugin</a>
		
			<a href="/blog/tags/npm/">npm</a>
		
	</section>

			<section class="post__meta">
	<a href="/blog/donate.html" title="码字辛苦求打赏" class="u-clearfix wgt-shield">
		<span class="title">Donate</span>
		<span class="desc">￥￥￥</span>
	</a>

	<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" 
		title="知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议" class="u-clearfix wgt-shield">
		<span class="title">License</span>
		<span class="desc">CC BY-NC-SA</span>
	</a>
</section>
		</footer>

		
			<section id="wgt-comment" class="wgt-comment" data-permalink="/archives/npm-publish/">
	<div id="comment-list">
		<article>暂无数据</article>
	</div>

	<form id="comment-form" class="comment__form">
		<input type="text" 
			name="author" 
			class="comment--mb10 comment__contentAuthor" 
			required 
			max-length="15"
			placeholder="这里输入你的名字" />
		<input type="text" 
			name="content" 
			class="comment--mb10 comment__contentInput" 
			required
			max-length="150"
			placeholder="这里输入评论内容" />
		<input type="hidden" name="parentId" id="comment-reply-id" />
		<!-- <label>
			<span>Email: </span>
			<input type="email" name="email">
		</label>
		<label>
			<span>website: </span>
			<input type="url" name="website">
		</label> -->

		<footer class="comment--clearfix comment--tRight" id="comment-form-footer">
			<a id="comment-box-submit" class="comment--fontsizeMeta comment--colorAccent comment__submitReply">加上去</a>
		</footer>
	</form>
</section>
		
	</div>
</article>

		</div>
		
	</div>
</div>

<link rel="stylesheet" href="/blog//build/css/iconfont_201704181501.css">


	<footer class="wgt-footer" id="footer">
	<div class="center">
		<p>
		&copy; 
		2014-2018

		
			<a href="/blog/">Yuying Wu</a>
		

		&nbsp;|&nbsp;
		<a href="https://github.com/YuyingWu"><i class="iconfont icon-github"></i> Github</a>&nbsp;|&nbsp;
<a href="http://www.weibo.com/wuyuying1128"><i class="iconfont icon-weibo"></i> 微博</a>&nbsp;|&nbsp;
<a href="http://www.douban.com/people/wuyuying1128/"><i class="iconfont icon-douban"></i>豆瓣</a>
		</p>
		<p>
			京ICP备16019960号&nbsp;
			Powered by 
			<a href="https://hexo.io" target="_blank">Hexo</a>, using theme 
			<a href="https://github.com/YuyingWu/hexo-theme-fresh" 
				target="_blank">Fresh</a>
		.</p>
	</div>
</footer>



<script src="http://cdn1.lncld.net/static/js/2.1.4/av-min.js"></script>
<script src="http://apps.bdimg.com/libs/zepto/1.1.4/zepto.min.js"></script>
<script src="http://cdn.bootcss.com/moment.js/2.18.1/moment.min.js"></script>
<script src="/blog//build/js/comment.js"></script>


<script src="//sinacloud.net/woodysblog/statics/lazyload.js"></script>
<script>
	new LazyLoad({
		threshold: 600
	});
</script>
<script src="/blog//dist/base.js"></script>
</body>
</html>